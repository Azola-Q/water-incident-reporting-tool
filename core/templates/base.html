{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %} Incident Reporting Tool{% endblock %}</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <style>
    body {
      background-image: url("{% static 'core/tap.jpg' %}");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

     #top-button {
    transition: bottom 0.4s ease, transform 0.3s ease;
    animation: slideInUp 0.5s ease-out forwards;
  }

  #top-button:hover {
    animation: none;
    transform: scale(1.1);
    box-shadow: 0 8px 15px rgba(59, 130, 246, 0.5);
  }

  @keyframes slideInUp {
    0% {
      opacity: 0;
      transform: translateY(50px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Optional pulsing glow on idle */
  #top-button::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    background: rgba(59, 130, 246, 0.4);
    border-radius: 9999px;
    transform: translate(-50%, -50%);
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s;
  }

  #top-button:hover::after {
    animation: pulseGlow 1.5s infinite;
    opacity: 1;
  }

  @keyframes pulseGlow {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.5;
    }
    70% {
      transform: translate(-50%, -50%) scale(1.5);
      opacity: 0;
    }
    100% {
      transform: translate(-50%, -50%) scale(1.5);
      opacity: 0;
    }
  }
  @keyframes breathing {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.breathing-hover:hover {
  animation: breathing 1.6s ease-in-out infinite;
}
@keyframes floatIn {
  from {
    opacity: 0;
    transform: translateX(100px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.animate-float-in {
  animation: floatIn 1s ease-out forwards;
}

  
  </style>
</head>

<body class="bg-gray-100 min-h-screen">

  <!-- Navbar -->
  <nav class="bg-blue-400 bg-opacity-70 backdrop-blur-md text-white p-4 shadow fixed w-full top-0 z-50 transition duration-300 hover:shadow-xl hover:brightness-105 hover:drop-shadow-md">
    <div class="container mx-auto flex items-center justify-between flex-wrap">

      <!-- Logo and Title -->
      <div class="flex items-center space-x-3 mb-2 md:mb-0">
        <a href="{% url 'login' %}" class="flex items-center space-x-3 group transition duration-300">
          <img src="{% static 'core/logo.jpg' %}" alt="Logo"
               class="w-12 h-12 rounded-full shadow-xl transition transform duration-300 hover:scale-110 hover:shadow-2xl hover:ring-2 hover:ring-white hover:ring-opacity-80" />
          <h1 class="text-xl font-bold text-white animate-float-in">
  Water Incident Reporting Tool
</h1>
        </a>
      </div>

      <!-- Hamburger Toggle -->
      <div class="md:hidden">
        <button id="nav-toggle" class="text-white focus:outline-none">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>

      <!-- Nav Links -->
<div id="nav-menu"
     class="w-full md:w-auto md:flex hidden flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 mt-4 md:mt-0 text-sm md:text-base">
  {% if user.is_authenticated %}
    <a href="{% url 'edit_details' %}"
       class="px-4 py-2 rounded text-white bg-blue-800 bg-opacity-70 hover:bg-blue-300 hover:bg-opacity-90 shadow-md hover:shadow-lg transition duration-300 backdrop-blur-md breathing-hover">
      Edit Details
    </a>
    <a href="{% url 'status' %}"
       class="px-4 py-2 rounded text-white bg-blue-800 bg-opacity-70 hover:bg-blue-300 hover:bg-opacity-90 shadow-md hover:shadow-lg transition duration-300 backdrop-blur-md breathing-hover">
      Status
    </a>
    {% if user.is_admin %}
    <a href="{% url 'admin_home' %}"
       class="px-4 py-2 rounded text-white bg-blue-800 bg-opacity-70 hover:bg-blue-300 hover:bg-opacity-90 shadow-md hover:shadow-lg transition duration-300 backdrop-blur-md breathing-hover">
      Admin Dashboard
    </a>
    {% endif %}
    <a href="{% url 'logout' %}"
       class="px-4 py-2 rounded text-white bg-red-800 bg-opacity-70 hover:bg-red-300 hover:bg-opacity-90 shadow-md hover:shadow-lg transition duration-300 backdrop-blur-md breathing-hover">
      Logout
    </a>
  {% else %}
    <a href="{% url 'login' %}"
       class="px-4 py-2 rounded text-white bg-blue-800 bg-opacity-70 hover:bg-blue-300 hover:bg-opacity-90 shadow-md hover:shadow-lg transition duration-300 backdrop-blur-md breathing-hover">
      Login
    </a>
    <a href="{% url 'register' %}"
       class="px-4 py-2 rounded text-white bg-blue-800 bg-opacity-70 hover:bg-blue-300 hover:bg-opacity-90 shadow-md hover:shadow-lg transition duration-300 backdrop-blur-md breathing-hover">
      Register
    </a>
    <a href="{% url 'forgot_password' %}"
       class="px-4 py-2 rounded text-white bg-blue-800 bg-opacity-70 hover:bg-blue-300 hover:bg-opacity-90 shadow-md hover:shadow-lg transition duration-300 backdrop-blur-md breathing-hover">
      Forgot Password
    </a>
  {% endif %}
</div>

    </div>
  </nav>

  <!-- Page Content -->
  <div class="container mx-auto p-4 pt-28">
    {% if messages %}
      {% for message in messages %}
        <div class="px-4 py-3 rounded mb-4 border"
             style="color: navy; background-color: rgba(173, 216, 230, 0.3); border-color: rgba(173, 216, 230, 0.6);">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}

    {% block content %}{% endblock %}
  </div>

 <!-- Footer -->
<footer id="footer"
        class="fixed bottom-0 left-0 w-full bg-blue-100 bg-opacity-80 backdrop-blur-md text-blue-900 py-3 text-center text-sm shadow-inner z-40 transition duration-300 hover:shadow-xl hover:text-blue-800 hover:brightness-110 hover:drop-shadow-md animate-fade-in-up">
  <div class="container mx-auto">
    For Assistance Please Contact Us At: <br />
    <span class="font-medium">Call:</span> 0784 769 721 |
    <span class="font-medium">Email:</span> <a href="mailto:azolaqakaqu@gmail.com" class="underline hover:text-blue-700 transition duration-300">
      azolaqakaqu@gmail.com
    </a> |
    Created by <b>Azola Qakaqu</b> © 2025
  </div>
</footer>
  <!-- Back to Top -->
  <button id="top-button"
          onclick="window.scrollTo({top: 0, behavior: 'smooth'})"
          class="fixed bottom-6 right-6 bg-blue-500 text-white px-4 py-2 rounded-full shadow hover:bg-blue-600 z-50 backdrop-blur-md bg-opacity-70">
    ↑ Top
  </button>

  <!-- JavaScript -->
  <script>
    function toggleFooterVisibility() {
      const footer = document.getElementById('footer');
      const topButton = document.getElementById('top-button');
      const scrollY = window.scrollY;
      const winHeight = window.innerHeight;
      const docHeight = document.documentElement.scrollHeight;
      const nearBottom = scrollY + winHeight >= docHeight - 20;
      const noScroll = docHeight <= winHeight;

      if (nearBottom || noScroll) {
        footer.classList.add('opacity-100');
        footer.classList.remove('opacity-0');
      } else {
        footer.classList.remove('opacity-100');
        footer.classList.add('opacity-0');
      }

      if (nearBottom) {
        topButton.style.bottom = '5rem';
      } else {
        topButton.style.bottom = '1.5rem';
      }
    }

    // Run on scroll & load
    window.addEventListener('scroll', toggleFooterVisibility);
    window.addEventListener('load', toggleFooterVisibility);

    // Navbar toggle
    document.getElementById('nav-toggle').addEventListener('click', function () {
      const menu = document.getElementById('nav-menu');
      menu.classList.toggle('hidden');
    });
  </script>
</body>
</html>
